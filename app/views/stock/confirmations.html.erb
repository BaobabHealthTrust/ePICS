<%= javascript_include_tag 'jquery' %>

<script type="text/javascript">
  <!--
  function authorise(row_id,authoriser_id)
  {
      if (authoriser_id == <%= User.current.id %>)
      {
         jQuery.ajax({
          type:"POST",
          url: "/stock/authorize_transaction",
          data: "id=" + row_id,
          success: function(){
           table = document.getElementById("pending")
           count = table.rows.length
           for(i=0; i < count; i++)
           {
               if (table.rows[i].id == row_id)
               {
                   table.deleteRow(i)
                   break
               }
           }
          }

         });
      }
      else
      {
          showMessage("You are not the selected authorizer of this transaction");
      }

  }

  function showPopUp(id) {
      document.getElementById('cover').style.display=''
      document.getElementById('details').style.display=''

  }

  function hidePopUp()
  {
      document.getElementById('cover').style.display='none'
      document.getElementById('details').style.display='none'
  }
  //-->
</script>
<style type="text/css">
  div.header{
      height: 80px;
      width: 100%;
      background-color: #FFDF33;
      text-align: center;
      font-size: 25px;
      font-weight: bold;
  }
  td{
      text-align: center;
      font-size: 20px;
      border: 0.01em solid gray;
  }

  th{
      border: 0.1em solid black;
      width: 15%;
      height: 40px;
      font-size: 23px;
  }
  tr.odd{
      background-color: #ABDDFC;
  }
  tr.even{
      background-color: #DAFF91;
  }
  #cover{
      position: absolute;
      background-color: black;
      width: 100%;
      height: 102%;
      left: 0%;
      top: 0%;
      z-index: 990;
      opacity: 0.5;
  }

  #details{
      position: absolute;
      width: 70%;
      height: 90%;
      background-color: #FAFAD2;
      top:5%;
      left:15%;
      z-index: 999;
  }

</style>

<div class="header">
    <br/>
    Transactions Awaiting Authorization
</div>

<div style="height:585px; border: 1px solid black; width: 100%;overflow: auto;">
  <table id="pending"  style="width: 99.9%">
    <tr>
      <th>Transaction Type</th><th>Corresponding Facility</th>
      <th>Person To Authorize</th><th style="border: 0em">&nbsp</th> <th style="border: 0em">&nbsp</th>
    </tr>
    <% @reminders.each do |key,details|%>
        <%#= raise transact.inspect %>
      <tr id ="<%= key %>" class="<%= cycle('odd','even') %>">
        <td><%= details["trans_type"] %></td><td><%= details["facility"] %></td>
        <td><%= details["authorizer"] %></td>
        <td><button style="width: 90%" onclick="showPopUp(<%= key %>)" > <span>View Details</span></button></td>
        <td><button onclick="authorise(<%= key %>,<%= details["authorizer_id"] %>)" style="width: 90%; display:<%= @can_authorize %> "
                    id ="<%= key %>"><span>Authorise</span> </button></td>
      </tr>
    <% end %>
  </table>
</div>
<div id="details" style="display: none">
  <table style="width: 100%">
    <caption style="font-size: 25px;font-weight: bold;">Details Of transaction</caption>
    <tr>
      <td></td>
    </tr>
  </table>
  <div style="width: 99%; border: 0.2em solid #000000;height:400px;">

  </div>
  <div style="position: absolute;top:90%; width: 100%">
     <button style="width: 20%;margin-left: 40%;" onclick="hidePopUp()"><span>Done</span></button>
  </div>
</div>
<div id="cover" style="display: none">

</div>


<div id="buttons" class="buttonsDiv">
  <button style="float: right;" class="green" onclick="window.location='/'"><span>Finish</span></button>

</div>