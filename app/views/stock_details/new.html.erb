<script type='text/javascript'><!--

	tt_cancel_show='/stock/new'
	tt_cancel_destination='/stock/new'
        showDate = false

        function set_ajaxURL_for_suggestions(value) {
          url = "/product/get_products?product_category_id=" + value ;
          $('touchscreenInput'+tstCurrentPage).setAttribute('ajaxURL', url);
          listSuggestions(tstCurrentPage);
       }

         

        function showExpiryDateOrNot() {
          product_name =  $("product_name").value;

          if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari  
            xmlhttp=new XMLHttpRequest();                                             
          }else{// code for IE6, IE5                                                  
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");                           
          }                                                                           
          xmlhttp.onreadystatechange=function() {                                     
            if (xmlhttp.readyState==4 && xmlhttp.status==200) {                       
              var results = xmlhttp.responseText;
 
              if(results == 'true') {
                showDate = true;
                return;
              }else{
                showDate = false;
                return;
              }                                                                       
            }                                                                         
          }                                                                           
          xmlhttp.open("GET","/product/expire?product_name="+product_name,true);
          xmlhttp.send();

        }

        function showExpiryDate() {
          return showDate;
        }

//-->
</script>

<%= form_tag :action => 'create', :method => :post  do %>

 <%= select_tag "stock_details[location_id]", options_for_select(@locations_map),
    {:id => "stock_details_location_id",:field_type => 'alpha',
    :helpText => "Select Item Location"} %>

<%= select_tag "stock_details[product_category_id]", options_for_select(@product_category_map),
      { :id => "product_category_id",
        :field_type => 'alpha',
        :helpText => "Select Item Category"} %>

  <%= select_tag "stock_details[product_name]", nil,
      {:id => "product_name",
      :field_type => 'alpha',
      :tt_onLoad => 'set_ajaxURL_for_suggestions($("product_category_id").value);',
      :tt_onUnLoad => 'showExpiryDateOrNot();',
      :helpText => "Select Item"} %>


  <%= text_field_tag "stock_details[expiry_date]", nil,
    {:id => "product_expire",
     :field_type => 'date',
     :condition => 'showExpiryDate();',
     :helpText => "Select Item Expiry Date"} %>

  <%= text_field_tag "stock_details[quantity]", nil,
       {:id => 'product_quantity', :field_type => 'number',
        :helpText => 'Select Item Quantity'} %>

  <%= submit_tag "Create Stock Details" %>


<% end %>
